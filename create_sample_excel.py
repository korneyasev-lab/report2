"""
Скрипт для создания формы Главного инженера
На основе реальных вопросов из документа
"""

import openpyxl
from openpyxl.styles import Font, Alignment
import os

def create_glavniy_injener_form():
    """Создать форму для Главного инженера"""

    os.makedirs("формы", exist_ok=True)

    wb = openpyxl.Workbook()
    ws = wb.active
    ws.title = "Вопросы"

    # Заголовки (4 колонки)
    headers = ["Вопрос", "ГОСТ ИСО 9001", "Руководство по качеству", "Связанные документы"]
    ws.append(headers)

    for cell in ws[1]:
        cell.font = Font(bold=True, size=12)
        cell.alignment = Alignment(horizontal='center', vertical='center', wrap_text=True)

    # Документы Главного инженера
    docs_gi = {
        "план_оборуд": "План управления оборудованием",
        "график_ппр": "График ППР оборудования",
        "журнал_ппр": "Журнал ППР и средств измерения",
        "план_поверка": "План-график поверки/калибровки СИ",
        "журнал_поверка": "Журнал поверки/калибровки",
        "свидетельства": "Свидетельства о поверке СИ",
        "акт_приемки": "Акт приемки оборудования в эксплуатацию",
        "инструкции": "Инструкции по эксплуатации оборудования",
        "журнал_ознак": "Журнал ознакомления с инструкциями по оборудованию"
    }

    # 20 вопросов из документа
    questions_data = [
        {
            "question": "План управления оборудованием на текущий квартал утвержден директором ФБП?",
            "gost": "Пункт 6.2: Организация должна устанавливать цели в области качества для соответствующих функций, уровней и процессов.",
            "quality": "Раздел 5.1 ПП.О2: Ежеквартально составляется План управления оборудованием. План составляет ГИ, согласовывает директор НПФ, утверждает директор ФБП.",
            "documents": docs_gi["план_оборуд"]
        },
        {
            "question": "Мероприятия по плану управления оборудованием выполняются в установленные сроки?",
            "gost": "Пункт 8.1: Организация должна планировать, внедрять и управлять процессами, необходимыми для выполнения требований.",
            "quality": "Раздел 5.2 ПП.О2: В рамках реализации Плана ГИ осуществляет поиск, закупку, приемку и введение в эксплуатацию нового оборудования, модернизацию и улучшение имеющегося оборудования.",
            "documents": docs_gi["план_оборуд"]
        },
        {
            "question": "График планово-предупредительного ремонта (ППР) оборудования составлен и актуализирован?",
            "gost": "Пункт 7.1.3: Организация должна обеспечивать техническое обслуживание инфраструктуры для обеспечения постоянной пригодности к применению.",
            "quality": "Раздел 5.5 ПП.О2: ГИ ежегодно составляет и утверждает у ДНПФ график ППР оборудования, введенного в эксплуатацию. ГИ ежеквартально осуществляет проверку и актуализацию графика ППР.",
            "documents": docs_gi["график_ппр"]
        },
        {
            "question": "Мероприятия по графику ППР оборудования выполняются согласно утвержденному графику?",
            "gost": "Пункт 7.1.3: Организация должна поддерживать инфраструктуру для достижения соответствия продукции и услуг.",
            "quality": "Раздел 7.1 ПП.О2: Задачи исполнителям по обслуживанию оборудования ставит ГИ в журнале выполнения работ в соответствии с графиком ППР. После выполнения работ ГИ проверяет выполненную работу и делает запись в Журнале по результатам ППР.",
            "documents": f"{docs_gi['график_ппр']}, {docs_gi['журнал_ппр']}"
        },
        {
            "question": "План-график поверки/калибровки средств измерений составлен на текущий год?",
            "gost": "Пункт 7.1.5.2: Средства измерения должны быть калиброваны или поверены через установленные интервалы времени или до их применения.",
            "quality": "Раздел 6.1 ПП.О2: Ежегодно ГИ составляет план-график поверки/калибровки СИ. При необходимости закупаются и вводятся в эксплуатацию новые единицы СИ, которые также включаются в план-график.",
            "documents": docs_gi["план_поверка"]
        },
        {
            "question": "Проведен анализ технического состояния производственного оборудования за отчетный период?",
            "gost": "Пункт 7.1.3: Организация должна определить, обеспечить и поддерживать в рабочем состоянии инфраструктуру, необходимую для функционирования процессов и достижения соответствия продукции.",
            "quality": "Раздел 5.2 ПП.О2: ГИ осуществляет контроль состояния оборудования. ДНПФ контролирует выполнение планов посредством проведения ежемесячного совещания с ГИ. В ходе совещания ГИ отчитывается о выполнении планов.",
            "documents": docs_gi["журнал_ппр"]
        },
        {
            "question": "Все технологическое оборудование находится в работоспособном состоянии?",
            "gost": "Пункт 7.1.3: Организация должна определять инфраструктуру, необходимую для функционирования процессов и обеспечения соответствия продукции.",
            "quality": "Раздел 7.4 ПП.О2: Оборудование, признанное по результатам обслуживания и/или ремонта непригодным к работе, изымается из пользования, списывается в установленном порядке и утилизируется. Действия контролируются и обеспечиваются ГИ.",
            "documents": docs_gi["журнал_ппр"]
        },
        {
            "question": "Зафиксированы случаи простоя производства по причине отказа оборудования? Приняты меры?",
            "gost": "Пункт 10.2: При возникновении несоответствия организация должна реагировать на него, а также оценивать необходимость действий по устранению причин.",
            "quality": "Таблица 1 ПП.О2 (Критерий 2): Количество простоев производства по причине отказа оборудования. ГИ до 20 числа каждого месяца предоставляет директору НПФ отчет по мониторингу и измерению процесса.",
            "documents": docs_gi["журнал_ппр"]
        },
        {
            "question": "Выполнены плановые ремонтные работы согласно графику ППР?",
            "gost": "Пункт 7.1.3: Организация должна обеспечивать техническое обслуживание инфраструктуры для обеспечения постоянной пригодности к применению.",
            "quality": "Раздел 7.1 ПП.О2: ГИ контролирует своевременное выполнение мероприятий по обслуживанию и ППР оборудования, актуальности записей в журналах. Таблица 1 ПП.О2 (Критерий 3): Соблюдение сроков и объема работ ППР.",
            "documents": f"{docs_gi['график_ппр']}, {docs_gi['журнал_ппр']}"
        },
        {
            "question": "Имеются в наличии запасные части для критического оборудования в требуемом количестве?",
            "gost": "Пункт 8.1: Организация должна определять ресурсы, необходимые для достижения соответствия продукции и услуг требованиям.",
            "quality": "Раздел 7.1.2.1 РК: К ресурсам относятся материальные ресурсы. Раздел 7.1.3.1 РК: К средствам технологического оснащения относятся средства ТО и Р.",
            "documents": docs_gi["план_оборуд"]
        },
        {
            "question": "Поверка/калибровка средств измерений проводится в соответствии с планом-графиком?",
            "gost": "Пункт 7.1.5.2: Средства измерения должны быть калиброваны или поверены через установленные интервалы времени.",
            "quality": "Раздел 6.3 ПП.О2: Поверка и калибровка СИ выполняется в соответствии с планом-графиком. Таблица 1 ПП.О2 (Критерий 4): Соблюдение сроков поверки/калибровки средств измерения.",
            "documents": f"{docs_gi['план_поверка']}, {docs_gi['журнал_поверка']}"
        },
        {
            "question": "Все средства измерений имеют актуальные свидетельства о поверке/калибровке?",
            "gost": "Пункт 7.1.5.2: Организация должна сохранять соответствующую документированную информацию в качестве свидетельства пригодности для целей средств измерения.",
            "quality": "Раздел 7.2 ПП.О2: Метрологическая аттестация СИ проводится аккредитованными организациями. Записи по итогам заносятся ГИ в Журнал поверки/калибровки.",
            "documents": f"{docs_gi['журнал_поверка']}, {docs_gi['свидетельства']}"
        },
        {
            "question": "СИ имеют маркировку о статусе поверки для обеспечения идентификации пригодности?",
            "gost": "Пункт 7.1.5.2: Средства измерения должны быть идентифицированы для обеспечения возможности определения их статуса.",
            "quality": "Раздел 7.2 ПП.О2: СИ, которое прошло поверку/калибровку маркируется специальными стикерами, для обеспечения идентификации пригодности.",
            "documents": docs_gi["свидетельства"]
        },
        {
            "question": "Неисправные СИ изъяты из пользования? Результаты измерений на неисправных СИ перепроверены?",
            "gost": "Пункт 7.1.5.2: Если средства измерения признаны непригодными, организация должна определить, была ли поставлена под сомнение правильность предыдущих результатов измерений.",
            "quality": "Раздел 7.5 ПП.О2: Неисправное СИ изымается из пользования, отправляется в ремонт и последующую поверку/калибровку. Результаты мониторинга и измерений, выполненные на СИ, которые признаны непригодными, перепроверяются на пригодных СИ.",
            "documents": docs_gi["журнал_поверка"]
        },
        {
            "question": "Техническая документация на оборудование актуализирована и доступна?",
            "gost": "Пункт 7.5.3: Организация должна управлять документированной информацией для обеспечения ее доступности и пригодности к использованию.",
            "quality": "Раздел 5.4 ПП.О2: Документация на оборудование передается ГИ при приемке оборудования. Документация на оборудование, инструкции по эксплуатации и ТБ с листами ознакомления хранится у ГИ.",
            "documents": f"{docs_gi['акт_приемки']}, {docs_gi['инструкции']}"
        },
        {
            "question": "Персонал обучен работе на технологическом оборудовании? Проведены инструктажи по ТБ?",
            "gost": "Пункт 7.2: Организация должна определять необходимую компетентность лиц, выполняющих работу под ее управлением, которая влияет на результаты деятельности.",
            "quality": "Раздел 5.2 ПП.О2: ГИ обеспечивает обучение персонала работе на новом оборудовании, обеспечение наличия инструкций по эксплуатации и ТБ к новому оборудованию и размещения копий на местах использования, ознакомление персонала с инструкциями под подпись.",
            "documents": f"{docs_gi['инструкции']}, {docs_gi['журнал_ознак']}"
        },
        {
            "question": "Инструкции по эксплуатации оборудования и технике безопасности доступны на рабочих местах?",
            "gost": "Пункт 7.5.3.2: Документированная информация должна быть доступна и пригодна к использованию там и тогда, где и когда она требуется.",
            "quality": "Раздел 5.2 ПП.О2: ГИ обеспечивает наличие инструкций по эксплуатации и ТБ к оборудованию и размещения копий инструкций на местах его использования.",
            "documents": docs_gi["инструкции"]
        },
        {
            "question": "Проведена оценка поставщиков оборудования и услуг по установленным критериям?",
            "gost": "Пункт 8.4.1: Организация должна обеспечивать, чтобы процессы, продукция и услуги, поставляемые внешними поставщиками, соответствовали требованиям.",
            "quality": "Раздел 8.1 ПП.О2: При выборе поставщиков оборудования ГИ проводит оценку по критериям: качество, цена, условия оплаты и доставки, наличие необходимых моделей в ассортименте, условия обслуживания, замены и ремонта по гарантии.",
            "documents": ""
        },
        {
            "question": "Выполнены мероприятия по энергосбережению согласно плану?",
            "gost": "Пункт 8.1: Организация должна устанавливать критерии для процессов и управление процессами в соответствии с этими критериями.",
            "quality": "Раздел 5.2 ПП.О2: В рамках реализации Плана управления оборудованием ГИ осуществляет модернизацию и улучшение имеющегося оборудования.",
            "documents": docs_gi["план_оборуд"]
        },
        {
            "question": "Предложены мероприятия по улучшению процесса управления оборудованием?",
            "gost": "Пункт 10.3: Организация должна постоянно улучшать пригодность, адекватность и результативность системы менеджмента качества.",
            "quality": "Раздел 9.1 ПП.О2: ГИ предоставляет отчет директору НПФ по мониторингу и измерению процесса. ГИ вправе представить в отчете предложения по улучшению процесса.",
            "documents": ""
        }
    ]

    # Добавляем данные в Excel
    for item in questions_data:
        ws.append([item["question"], item["gost"], item["quality"], item["documents"]])

    # Настройка ширины колонок
    ws.column_dimensions['A'].width = 70
    ws.column_dimensions['B'].width = 85
    ws.column_dimensions['C'].width = 90
    ws.column_dimensions['D'].width = 55

    # Выравнивание и перенос текста
    for row in ws.iter_rows(min_row=2, max_row=ws.max_row):
        for cell in row:
            cell.alignment = Alignment(vertical='top', wrap_text=True)

    # Сохраняем файл
    file_path = "формы/Главный_инженер.xlsx"
    wb.save(file_path)
    print(f"✅ Файл успешно создан: {file_path}")
    print(f"📊 Добавлено {len(questions_data)} вопросов")
    print(f"📄 Формат: Вопрос | ГОСТ ИСО 9001 | РК | Связанные документы")
    print("\n🚀 Запустите программу: python main.py")

if __name__ == "__main__":
    create_glavniy_injener_form()